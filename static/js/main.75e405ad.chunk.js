(this["webpackJsonpreact-mesto"]=this["webpackJsonpreact-mesto"]||[]).push([[0],{19:function(e,t,n){},37:function(e,t,n){"use strict";n.r(t);var a=n(1),c=n.n(a),o=n(21),s=n.n(o),i=n(8),r=(n(19),n(25)),l=n(3),u=n(2),p=c.a.createContext(),j=n(0);function d(e){var t=e.card,n=e.onCardClick,a=e.onCardLike,o=e.onCardDelete;var s=c.a.useContext(p),i=t.owner._id===s._id,r="elements__delete-button ".concat(i?"elements__delete-button_visible":"elements__delete-button_hidden"),l=t.likes.some((function(e){return e._id===s._id})),u="elements__like-button ".concat(l?"elements__like-button_active":null);return Object(j.jsxs)("li",{className:"elements__card",children:[Object(j.jsx)("img",{className:"elements__image",src:t.link,alt:t.name,onClick:function(){n(t)}}),Object(j.jsx)("button",{className:r,type:"button",onClick:function(){o(t)}}),Object(j.jsxs)("div",{className:"elements__info",children:[Object(j.jsx)("h2",{className:"elements__text",children:t.name}),Object(j.jsxs)("div",{className:"elements__like",children:[Object(j.jsx)("button",{type:"button",className:u,"aria-label":"\u041b\u0430\u0439\u043a",onClick:function(){a(t)}}),Object(j.jsx)("p",{className:"elements__like-counter",children:t.likes.length})]})]})]})}var m=n.p+"static/media/logo.a307e1c4.svg";var b=function(e){var t=e.loggedIn,n=e.loginText,a=e.onClick,c=e.link,o=e.login;return Object(j.jsxs)("header",{className:"header",children:[Object(j.jsx)("img",{src:m,alt:"\u041b\u043e\u0433\u043e",className:"header__logo"}),Object(j.jsxs)("div",{className:"header__container",children:[Object(j.jsx)("p",{className:"header__email",children:o}),Object(j.jsx)(i.b,{to:c,className:"".concat(t?"header__link_singout":""," header__link"),onClick:a,children:n})]})]})};var h=function(e){var t=e.loginData,n=e.loggedIn,a=e.onSignOut,o=e.onEditProfile,s=e.onAddPlace,i=e.onEditAvatar,r=e.onCardClick,l=e.cards,u=e.onCardLike,m=e.onCardDelete,h=c.a.useContext(p);return Object(j.jsxs)(j.Fragment,{children:[Object(j.jsx)(b,{loggedIn:n,login:t,link:"/sign-in",onClick:a,loginText:"\u0412\u044b\u0439\u0442\u0438"}),Object(j.jsxs)("main",{children:[Object(j.jsxs)("section",{className:"profile",children:[Object(j.jsxs)("div",{className:"profile__avatar-containter",children:[Object(j.jsx)("img",{alt:h.name,className:"profile__avatar",src:h.avatar}),Object(j.jsx)("button",{type:"button",className:"profile__avatar-edit-button",onClick:i})]}),Object(j.jsxs)("div",{className:" profile__columns",children:[Object(j.jsx)("h1",{className:"profile__name",children:h.name}),Object(j.jsx)("button",{type:"button",className:"profile__edit-button","aria-label":"\u0420\u0435\u0434\u0430\u043a\u0442\u0438\u0440\u043e\u0432\u0430\u0442\u044c",onClick:o}),Object(j.jsx)("p",{className:"profile__job",children:h.about})]}),Object(j.jsx)("button",{type:"button",className:"profile__add-button","aria-label":"\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c",onClick:s})]}),Object(j.jsx)("section",{className:"elements",children:Object(j.jsx)("ul",{className:"elements__list",children:l.map((function(e){return Object(j.jsx)(d,{card:e,onCardClick:r,onCardLike:u,onCardDelete:m},e._id)}))})})]})]})};var _=function(){return Object(j.jsx)("footer",{className:"footer",children:Object(j.jsx)("p",{className:"footer__copyright",children:"\xa9 2020 Mesto Russia"})})};function f(e){var t=e.card,n=e.onClose;return t?Object(j.jsx)("section",{className:"".concat(t?"popup_opened":""," popup popup_photo"),children:Object(j.jsxs)("div",{className:"popup__container popup__container_photo",children:[Object(j.jsx)("button",{className:"popup__close-button popup__close-button_photo","aria-label":"\u0417\u0430\u043a\u0440\u044b\u0442\u044c",onClick:n}),Object(j.jsx)("img",{className:"popup__img",alt:t.name,src:t.link}),Object(j.jsx)("p",{className:"popup__caption",children:t.name})]})}):null}var O=function(e){var t=e.title,n=e.name,a=e.button,c=e.children,o=e.isOpen,s=e.onClose,i=e.onSubmit;return Object(j.jsx)("section",{className:"".concat(o?"popup_opened":""," popup popup_").concat(n),children:Object(j.jsxs)("div",{className:"popup__container",children:[Object(j.jsx)("button",{type:"button",className:"popup__close-button",onClick:s}),Object(j.jsxs)("form",{className:"popup__form popup__form_".concat(n),onSubmit:i,children:[Object(j.jsx)("h3",{className:"popup__title",children:t}),c,Object(j.jsx)("button",{type:"submit",className:"popup__save-button",children:a})]})]})})};function g(e){var t=e.isOpen,n=e.onClose,a=e.onUpdateUser,o=c.a.useState(""),s=Object(l.a)(o,2),i=s[0],r=s[1];var u=c.a.useState(""),d=Object(l.a)(u,2),m=d[0],b=d[1];var h=c.a.useContext(p);return c.a.useEffect((function(){h&&(r(h.name),b(h.about))}),[h]),Object(j.jsxs)(O,{isOpen:t,onClose:n,onSubmit:function(e){e.preventDefault(),a({name:i,about:m})},title:"\u0420\u0435\u0434\u0430\u043a\u0442\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u043f\u0440\u043e\u0444\u0438\u043b\u044c",name:"edit",button:"\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c",children:[Object(j.jsxs)("label",{className:"popup__field popup__field_first",children:[Object(j.jsx)("input",{value:i,onChange:function(e){r(e.target.value)},type:"text",name:"name",className:"popup__input popup__input_type_name",id:"name-input",required:!0,minLength:"2",maxLength:"40"}),Object(j.jsx)("span",{className:"popup__error",id:"name-input-error"})]}),Object(j.jsxs)("label",{className:"popup__field",children:[Object(j.jsx)("input",{value:m,onChange:function(e){b(e.target.value)},type:"text",name:"about",className:"popup__input popup__input_type_job",id:"job-input",required:!0,minLength:"2",maxLength:"200"}),Object(j.jsx)("span",{className:"popup__error",id:"job-input-error"})]})]})}function x(e){var t=e.isOpen,n=e.onClose,a=e.onUpdateAvatar,o=c.a.useRef();return Object(j.jsxs)(O,{isOpen:t,onClose:n,onSubmit:function(e){e.preventDefault(),a({avatar:o.current.value}),o.current.value=""},title:"\u041e\u0431\u043d\u043e\u0432\u0438\u0442\u044c \u0430\u0432\u0430\u0442\u0430\u0440",name:"edit-avatar",button:"\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c",children:[Object(j.jsx)("input",{ref:o,type:"url",name:"avatar",placeholder:"\u0421\u0441\u044b\u043b\u043a\u0430 \u043d\u0430 \u043a\u0430\u0440\u0442\u0438\u043d\u043a\u0443",className:"popup__input popup__input_type_img",id:"img-input",required:!0}),Object(j.jsx)("span",{className:"popup__error",id:"img-input-error"})]})}function v(e){var t=e.isOpen,n=e.onClose,a=e.onAddPlace,o=c.a.useState(),s=Object(l.a)(o,2),i=s[0],r=s[1];var u=c.a.useState(),p=Object(l.a)(u,2),d=p[0],m=p[1];return Object(j.jsxs)(O,{isOpen:t,onClose:n,onSubmit:function(e){e.preventDefault(),a({name:i,link:d}),r(""),m("")},title:"\u041d\u043e\u0432\u043e\u0435 \u043c\u0435\u0441\u0442\u043e",name:"place",button:"\u0421\u043e\u0437\u0434\u0430\u0442\u044c",children:[Object(j.jsxs)("label",{className:"popup__field popup__field_first",children:[Object(j.jsx)("input",{value:i,onChange:function(e){r(e.target.value)},type:"text",name:"name",placeholder:"\u041d\u0430\u0437\u0432\u0430\u043d\u0438\u0435",className:"popup__input popup__input_type_place",id:"place-input",required:!0,minLength:"2",maxLength:"30"}),Object(j.jsx)("span",{className:"popup__error",id:"place-input-error"})]}),Object(j.jsxs)("label",{className:"popup__field",children:[Object(j.jsx)("input",{value:d,onChange:function(e){m(e.target.value)},type:"url",name:"link",placeholder:"\u0421\u0441\u044b\u043b\u043a\u0430 \u043d\u0430 \u043a\u0430\u0440\u0442\u0438\u043d\u043a\u0443",className:"popup__input popup__input_type_img",id:"img-input",required:!0}),Object(j.jsx)("span",{className:"popup__error",id:"img-input-error"})]})]})}var N=n.p+"static/media/login.1b6082f8.svg",C=n.p+"static/media/loginErr.df8eddf6.svg";function k(e){var t=e.isOpen,n=e.onClose,a=e.isRequestSuccessful;return Object(j.jsx)("section",{className:"".concat(t?"popup_opened":""," popup"),children:Object(j.jsxs)("div",{className:"popup__container popup__container_login",children:[Object(j.jsx)("button",{className:"popup__close-button popup__close-button_infotool","aria-label":"\u0417\u0430\u043a\u0440\u044b\u0442\u044c",onClick:n}),Object(j.jsx)("img",{className:"popup__login-img",alt:"info",src:"".concat(a?N:C)}),Object(j.jsx)("p",{className:"popup__login-text",children:"".concat(a?"\u0412\u044b \u0443\u0441\u043f\u0435\u0448\u043d\u043e \u0437\u0430\u0440\u0435\u0433\u0435\u0441\u0442\u0440\u0438\u0440\u043e\u0432\u0430\u043d\u044b":"\u0427\u0442\u043e-\u0442\u043e \u043f\u043e\u0448\u043b\u043e \u043d\u0435 \u0442\u0430\u043a. \u041f\u043e\u043f\u0440\u043e\u0431\u0443\u0439\u0442\u0435 \u0435\u0449\u0451 \u0440\u0430\u0437")})]})})}var y=n(11),S=n(9);var L=function(e){var t=e.onRegister,n=e.onInfoTooltip,a=c.a.useState({email:"",password:""}),o=Object(l.a)(a,2),s=o[0],r=o[1];function u(e){var t=e.target,n=t.name,a=t.value;r(Object(S.a)(Object(S.a)({},s),{},Object(y.a)({},n,a)))}return Object(j.jsxs)(j.Fragment,{children:[Object(j.jsx)(b,{loginText:"\u0412\u043e\u0439\u0442\u0438",link:"/sign-in"}),Object(j.jsx)("section",{className:"form",children:Object(j.jsxs)("form",{onSubmit:function(e){e.preventDefault(),t(s)},className:"form__container form__containe_type_register",children:[Object(j.jsx)("h3",{className:"form__title",children:"\u0420\u0435\u0433\u0438\u0441\u0442\u0440\u0430\u0446\u0438\u044f"}),Object(j.jsxs)("label",{className:"form__field",children:[Object(j.jsx)("input",{value:s.email,onChange:u,placeholder:"Email",type:"email",name:"email",className:"form__input form__input_type_register",id:"email",required:!0,minLength:"2",maxLength:"40"}),Object(j.jsx)("span",{className:"form__error",id:"email-error"})]}),Object(j.jsxs)("label",{className:"form__field",children:[Object(j.jsx)("input",{value:s.password,onChange:u,placeholder:"\u041f\u0430\u0440\u043e\u043b\u044c",type:"text",name:"password",className:"form__input form__input_type_password",id:"password",required:!0,minLength:"2",maxLength:"200"}),Object(j.jsx)("span",{className:"form__error",id:"password-error"})]}),Object(j.jsx)("button",{type:"submit",className:"form__save-button",onClick:n,children:"\u0417\u0430\u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0438\u0440\u043e\u0432\u0430\u0442\u044c\u0441\u044f"}),Object(j.jsx)(i.b,{to:"/sign-in",className:"form__sing-in-text",children:"\u0423\u0436\u0435 \u0437\u0430\u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0438\u0440\u043e\u0432\u0430\u043d\u044b? \u0412\u043e\u0439\u0442\u0438"})]})})]})};var w=function(e){var t=e.onLogin,n=c.a.useState({email:"",password:""}),a=Object(l.a)(n,2),o=a[0],s=a[1];function i(e){var t=e.target,n=t.name,a=t.value;s(Object(S.a)(Object(S.a)({},o),{},Object(y.a)({},n,a)))}return Object(j.jsxs)(j.Fragment,{children:[Object(j.jsx)(b,{loginText:"\u0420\u0435\u0433\u0438\u0441\u0442\u0440\u0430\u0446\u0438\u044f",link:"/sign-up"}),Object(j.jsx)("section",{className:"form",children:Object(j.jsxs)("form",{onSubmit:function(e){e.preventDefault(),t(o)},className:"form__container form__containe_type_register",children:[Object(j.jsx)("h3",{className:"form__title",children:"\u0412\u0445\u043e\u0434"}),Object(j.jsxs)("label",{className:"form__field",children:[Object(j.jsx)("input",{value:o.email,onChange:i,placeholder:"Email",type:"email",name:"email",className:"form__input form__input_type_register",id:"email",required:!0,minLength:"2",maxLength:"40"}),Object(j.jsx)("span",{className:"form__error",id:"email-error"})]}),Object(j.jsxs)("label",{className:"form__field",children:[Object(j.jsx)("input",{value:o.password,onChange:i,placeholder:"\u041f\u0430\u0440\u043e\u043b\u044c",type:"text",name:"password",className:"form__input form__input_type_password",id:"password",required:!0,minLength:"2",maxLength:"200"}),Object(j.jsx)("span",{className:"form__error",id:"password-error"})]}),Object(j.jsx)("button",{type:"submit",className:"form__save-button",children:"\u0412\u043e\u0439\u0442\u0438"})]})})]})},P=n(26),U=function(e){var t=e.component,n=Object(P.a)(e,["component"]);return Object(j.jsx)(u.b,{children:function(){return n.loggedIn?Object(j.jsx)(t,Object(S.a)({},n)):Object(j.jsx)(u.a,{to:"./sign-in"})}})},E=n(23),T=n(24),D=new(function(){function e(t){var n=t.baseUrl,a=t.headers;Object(E.a)(this,e),this.headers=a,this.baseUrl=n}return Object(T.a)(e,[{key:"getInitialCards",value:function(){return fetch("".concat(this.baseUrl,"/cards"),{headers:this.headers}).then((function(e){return e.ok?e.json():Promise.reject("\u041e\u0448\u0438\u0431\u043a\u0430: ".concat(e.status))}))}},{key:"getUserData",value:function(){return fetch("".concat(this.baseUrl,"/users/me"),{headers:this.headers}).then((function(e){return e.ok?e.json():Promise.reject("\u041e\u0448\u0438\u0431\u043a\u0430: ".concat(e.status))}))}},{key:"patchUserData",value:function(e){return fetch("".concat(this.baseUrl,"/users/me"),{method:"PATCH",headers:this.headers,body:JSON.stringify({name:e.name,about:e.about})}).then((function(e){return e.ok?e.json():Promise.reject("\u041e\u0448\u0438\u0431\u043a\u0430: ".concat(e.status))})).then((function(e){return e}))}},{key:"postCard",value:function(e){return fetch("".concat(this.baseUrl,"/cards"),{method:"POST",headers:this.headers,body:JSON.stringify({name:e.name,link:e.link})}).then((function(e){return e.ok?e.json():Promise.reject("\u041e\u0448\u0438\u0431\u043a\u0430: ".concat(e.status))})).then((function(e){return e}))}},{key:"patchUserAvatar",value:function(e){return fetch("".concat(this.baseUrl,"/users/me/avatar "),{method:"PATCH",headers:this.headers,body:JSON.stringify(e)}).then((function(e){return e.ok?e.json():Promise.reject("\u041e\u0448\u0438\u0431\u043a\u0430: ".concat(e.status))}))}},{key:"deleteCard",value:function(e){return fetch("".concat(this.baseUrl,"/cards/").concat(e),{method:"DELETE",headers:this.headers,body:JSON.stringify({_id:e})}).then((function(e){return e.ok?e.json():Promise.reject("\u041e\u0448\u0438\u0431\u043a\u0430: ".concat(e.status))}))}},{key:"putLike",value:function(e){return fetch("".concat(this.baseUrl,"/cards/likes/").concat(e),{method:"PUT",headers:this.headers,body:JSON.stringify({_id:e})}).then((function(e){return e.ok?e.json():Promise.reject("\u041e\u0448\u0438\u0431\u043a\u0430: ".concat(e.status))}))}},{key:"deleteLike",value:function(e){return fetch("".concat(this.baseUrl,"/cards/likes/").concat(e),{method:"DELETE",headers:this.headers,body:JSON.stringify({_id:e})}).then((function(e){return e.ok?e.json():Promise.reject("\u041e\u0448\u0438\u0431\u043a\u0430: ".concat(e.status))}))}},{key:"changeLikeCardStatus",value:function(e,t){return t?this.putLike(e):this.deleteLike(e)}}]),e}())({baseUrl:"https://mesto.nomoreparties.co/v1/cohort-17",headers:{authorization:"eae790ac-cf24-4380-ba85-8ea4c48ccac5","Content-Type":"application/json"}}),A="https://auth.nomoreparties.co",I=function(e){return e.ok?e.json():Promise.reject("\u041e\u0448\u0438\u0431\u043a\u0430")},q=function(e){return fetch("".concat(A,"/users/me"),{method:"GET",headers:{Accept:"application/json","Content-Type":"application/json",authorization:"Bearer ".concat(e)}}).then(I).catch((function(e){console.log(e)}))};var J=Object(u.h)((function(){var e=Object(a.useState)(!1),t=Object(l.a)(e,2),n=t[0],c=t[1],o=Object(a.useState)(!1),s=Object(l.a)(o,2),i=s[0],d=s[1],m=Object(a.useState)(!1),b=Object(l.a)(m,2),O=b[0],N=b[1],C=Object(a.useState)(!1),y=Object(l.a)(C,2),S=y[0],P=y[1],E=Object(a.useState)(!1),T=Object(l.a)(E,2),J=T[0],F=T[1],R=Object(a.useState)(null),B=Object(l.a)(R,2),z=B[0],H=B[1];function M(){c(!1),d(!1),N(!1),H(null)}var G=Object(a.useState)(""),K=Object(l.a)(G,2),Q=K[0],V=K[1];Object(a.useEffect)((function(){D.getUserData().then((function(e){V(e)})).catch((function(e){console.log(e)}))}),[]);var W=Object(a.useState)([]),X=Object(l.a)(W,2),Y=X[0],Z=X[1];Object(a.useEffect)((function(){D.getInitialCards().then((function(e){Z(e)})).catch((function(e){console.log(e)}))}),[]);var $=Object(a.useState)(!1),ee=Object(l.a)($,2),te=ee[0],ne=ee[1],ae=Object(u.g)();Object(a.useEffect)((function(){te&&ae.push("/")}),[ae,te]);var ce=Object(a.useState)({_id:"",email:""}),oe=Object(l.a)(ce,2),se=oe[0],ie=oe[1];return Object(a.useEffect)((function(){var e=localStorage.getItem("jwt");e&&q(e).then((function(e){e&&(ne(!0),ie(e.data))}))}),[]),Object(j.jsx)(p.Provider,{value:Q,children:Object(j.jsxs)("div",{className:"page",children:[Object(j.jsxs)(u.d,{children:[Object(j.jsx)(U,{exact:!0,path:"/",loggedIn:te,component:h,onEditProfile:function(){c(!0)},onAddPlace:function(){d(!0)},onEditAvatar:function(){N(!0)},onCardClick:function(e){H(e)},cards:Y,onCardLike:function(e){var t=e.likes.some((function(e){return e._id===Q._id}));D.changeLikeCardStatus(e._id,!t).then((function(t){var n=Y.map((function(n){return n._id===e._id?t:n}));Z(n)})).catch((function(e){console.log(e)}))},onCardDelete:function(e){D.deleteCard(e._id).then((function(){var t=Y.filter((function(t){return t._id!==e._id}));Z(t)})).catch((function(e){console.log(e)}))},onSignOut:function(){localStorage.removeItem("jwt"),F(!1)},loginData:se.email}),Object(j.jsx)(u.b,{path:"/sign-up",children:Object(j.jsx)(L,{onRegister:function(e){return function(e,t){return fetch("".concat(A,"/signup"),{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({email:e,password:t})}).then(I)}(e.email,e.password).then((function(e){if(!e||400===e.statusCode)throw new Error("\u0427\u0442\u043e-\u0442\u043e \u043d\u0435 \u0442\u0430\u043a \u0441 \u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0430\u0446\u0438\u0435\u0439");e.data&&F(!0)})).catch((function(e){console.log(e)}))},onInfoTooltip:function(){P(!0)}})}),Object(j.jsx)(u.b,{path:"/sign-in",children:Object(j.jsx)(w,{onLogin:function(e){return function(e,t){return fetch("".concat(A,"/signin"),{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({email:e,password:t})}).then(I).catch((function(e){console.log(e)}))}(e.email,e.password).then((function(e){if(!e||401===e.statusCode)throw P(!0),new Error("\u041f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044c \u043d\u0435 \u0437\u0430\u0440\u0435\u0433\u0435\u0441\u0440\u0438\u0440\u043e\u0432\u0430\u043d");if(!e||400===e.statusCode)throw P(!0),new Error("\u041d\u0435 \u043f\u0435\u0440\u0435\u0434\u0430\u043d\u043e \u043e\u0434\u043d\u043e \u0438\u0437 \u043f\u043e\u043b\u0435\u0439 ");e.token&&(ne(!0),F(!0),ae.push("/"),localStorage.setItem("jwt",e.token),q(e.token).then((function(e){e&&ie(e.data)})))})).catch((function(e){console.log(e)}))}})}),Object(j.jsx)(u.b,{children:te?Object(j.jsx)(u.a,{to:"/"}):Object(j.jsx)(u.a,{to:"/sign-in"})})]}),Object(j.jsx)(_,{}),Object(j.jsx)(x,{isOpen:O,onClose:M,onUpdateAvatar:function(e){D.patchUserAvatar(e).then((function(e){V(e),M()})).catch((function(e){console.log(e)}))}}),Object(j.jsx)(g,{isOpen:n,onClose:M,onUpdateUser:function(e){D.patchUserData(e).then((function(e){V(e),M()})).catch((function(e){console.log(e)}))}}),Object(j.jsx)(v,{isOpen:i,onClose:M,onAddPlace:function(e){D.postCard(e).then((function(e){Z([e].concat(Object(r.a)(Y))),M()})).catch((function(e){console.log(e)}))}}),Object(j.jsx)(f,{card:z,onClose:M}),Object(j.jsx)(k,{isOpen:S,onClose:function(){P(!1),J&&ae.push("/sing-in")},isRequestSuccessful:J})]})})})),F=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,38)).then((function(t){var n=t.getCLS,a=t.getFID,c=t.getFCP,o=t.getLCP,s=t.getTTFB;n(e),a(e),c(e),o(e),s(e)}))};s.a.render(Object(j.jsx)(c.a.StrictMode,{children:Object(j.jsx)(i.a,{children:Object(j.jsx)(J,{})})}),document.getElementById("root")),F()}},[[37,1,2]]]);
//# sourceMappingURL=main.75e405ad.chunk.js.map